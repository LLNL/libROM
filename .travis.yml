language: cpp
sudo: false
dist: trusty

cache:
  apt: true
  directories:
    - $HOME/.cache

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - g++-4.9
      - gfortran-4.9
      - libblas-dev
      - liblapack-dev
      - libopenmpi-dev
      - libhdf5-serial-dev
      - environment-modules
jobs:
  include:
    - stage: autotools
      script: ./autogen.sh
    - stage: configure
      script: ./configure --with-CXX=/usr/bin/mpic++ --with-hdf5=/usr/bin/h5cc --with-lapack='-lopenblas'
    - stage: build
      script: make -j
      
before_script:
  - export FC=gfortran-4.9
  - export F77=gfortran-4.9
